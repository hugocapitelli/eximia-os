{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://harven.ai/schemas/creator_output.json",
    "title": "Harven Creator Output Schema",
    "description": "Schema de saida do agente CreatorOS - perguntas socraticas geradas",
    "type": "object",
    "required": [
        "questions",
        "metadata"
    ],
    "properties": {
        "analysis": {
            "type": "object",
            "description": "Analise do conteudo que fundamentou a geracao",
            "properties": {
                "main_concepts": {
                    "type": "array",
                    "items": {"type": "string"},
                    "minItems": 3,
                    "maxItems": 7,
                    "description": "Conceitos principais identificados"
                },
                "key_relationships": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "Relacoes importantes entre conceitos"
                },
                "potential_angles": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "Angulos possiveis para perguntas"
                },
                "content_complexity": {
                    "type": "string",
                    "enum": ["baixa", "media", "alta"],
                    "description": "Complexidade avaliada do conteudo"
                }
            }
        },
        "questions": {
            "type": "array",
            "minItems": 1,
            "maxItems": 3,
            "description": "Perguntas socraticas geradas",
            "items": {
                "type": "object",
                "required": [
                    "text",
                    "skill",
                    "intention",
                    "expected_depth",
                    "common_shallow_answer",
                    "followup_prompts",
                    "citations"
                ],
                "properties": {
                    "id": {
                        "type": "string",
                        "description": "ID unico da pergunta"
                    },
                    "text": {
                        "type": "string",
                        "minLength": 50,
                        "maxLength": 500,
                        "pattern": ".*\\?$",
                        "description": "Texto completo da pergunta (deve terminar com ?)"
                    },
                    "skill": {
                        "type": "string",
                        "enum": ["analise", "sintese", "aplicacao", "reflexao"],
                        "description": "Habilidade cognitiva trabalhada"
                    },
                    "intention": {
                        "type": "string",
                        "minLength": 30,
                        "maxLength": 200,
                        "description": "Objetivo pedagogico da pergunta"
                    },
                    "expected_depth": {
                        "type": "string",
                        "minLength": 50,
                        "maxLength": 300,
                        "description": "O que uma boa resposta incluiria"
                    },
                    "common_shallow_answer": {
                        "type": "string",
                        "minLength": 20,
                        "maxLength": 150,
                        "description": "Resposta superficial tipica"
                    },
                    "followup_prompts": {
                        "type": "array",
                        "minItems": 2,
                        "maxItems": 3,
                        "items": {"type": "string"},
                        "description": "Perguntas de acompanhamento"
                    },
                    "citations": {
                        "type": "array",
                        "minItems": 1,
                        "items": {"type": "string"},
                        "description": "Referencias aos blocos de conteudo de origem"
                    },
                    "difficulty": {
                        "type": "string",
                        "enum": ["iniciante", "intermediario", "avancado"],
                        "description": "Nivel de dificuldade da pergunta"
                    },
                    "estimated_time": {
                        "type": "integer",
                        "minimum": 2,
                        "maximum": 15,
                        "description": "Tempo estimado em minutos para resposta completa"
                    },
                    "has_practical_scenario": {
                        "type": "boolean",
                        "description": "Se a pergunta usa cenario pratico"
                    },
                    "related_concepts": {
                        "type": "array",
                        "items": {"type": "string"},
                        "description": "Conceitos relacionados para indexacao"
                    }
                }
            }
        },
        "quality_checks": {
            "type": "object",
            "description": "Verificacoes de qualidade automaticas",
            "properties": {
                "all_questions_non_generic": {
                    "type": "boolean",
                    "description": "Nenhuma pergunta e generica"
                },
                "skills_diversity": {
                    "type": "boolean",
                    "description": "Pelo menos 2 skills diferentes"
                },
                "has_practical_scenario": {
                    "type": "boolean",
                    "description": "Pelo menos 1 pergunta com cenario pratico"
                },
                "all_metadata_complete": {
                    "type": "boolean",
                    "description": "Todos os metadados preenchidos"
                },
                "unique_angles": {
                    "type": "boolean",
                    "description": "Cada pergunta aborda angulo diferente"
                }
            }
        },
        "metadata": {
            "type": "object",
            "required": ["chapter_title", "questions_generated"],
            "properties": {
                "chapter_id": {
                    "type": "string"
                },
                "chapter_title": {
                    "type": "string"
                },
                "questions_generated": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 3
                },
                "skills_covered": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": ["analise", "sintese", "aplicacao", "reflexao"]
                    }
                },
                "has_practical_scenario": {
                    "type": "boolean"
                },
                "processing_time_ms": {
                    "type": "integer",
                    "description": "Tempo de processamento em millisegundos"
                },
                "model_used": {
                    "type": "string"
                },
                "tokens_used": {
                    "type": "object",
                    "properties": {
                        "prompt": {"type": "integer"},
                        "completion": {"type": "integer"},
                        "total": {"type": "integer"}
                    }
                },
                "generated_at": {
                    "type": "string",
                    "format": "date-time"
                }
            }
        },
        "warnings": {
            "type": "array",
            "items": {"type": "string"},
            "description": "Avisos sobre limitacoes ou problemas encontrados"
        }
    }
}
