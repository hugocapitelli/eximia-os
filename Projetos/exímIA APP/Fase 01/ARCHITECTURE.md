# Arquitetura â€” MÃ³dulo Biblioteca V3

> Modelo: CatÃ¡logo Global + Sistema de Favoritos
> Aprovado por: Aria (Architect) | 2026-02-01

---

## Modelo Simplificado

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FLUXO PRINCIPAL                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   ADMIN                           USUÃRIO
     â”‚                                â”‚
     â”‚ 1. Busca livro                 â”‚
     â”‚    (Google Books API)          â”‚
     â–¼                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  Adiciona   â”‚                       â”‚
â”‚ ao CatÃ¡logo â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                       â”‚
       â”‚                              â”‚
       â”‚ 2. Cria resumo               â”‚
       â”‚    (capÃ­tulos)               â”‚
       â–¼                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  Publica    â”‚                       â”‚
â”‚   Resumo    â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                       â”‚
       â”‚                              â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                      â”‚
                                      â”‚ 3. Navega catÃ¡logo
                                      â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚  Favorita   â”‚
                               â”‚    Livro    â”‚
                               â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ 4. LÃª resumo
                                      â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚ Modo Leituraâ”‚
                               â”‚  (progresso)â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Diagrama de Entidades

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CAMADA GLOBAL (Admin)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚   authors    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   book_catalog   â”‚                         â”‚
â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                         â”‚
â”‚  â”‚ id           â”‚          â”‚ id               â”‚                         â”‚
â”‚  â”‚ name (UNIQUE)â”‚          â”‚ google_books_id  â”‚ (UNIQUE)                â”‚
â”‚  â”‚ bio          â”‚          â”‚ title            â”‚                         â”‚
â”‚  â”‚ photo_url    â”‚          â”‚ author_name      â”‚                         â”‚
â”‚  â”‚ mind_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ description      â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ cover_url        â”‚                         â”‚
â”‚                            â”‚ favorites_count  â”‚ â† Auto-atualizado       â”‚
â”‚                            â”‚ added_by         â”‚ â† Admin                 â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                     â”‚                                    â”‚
â”‚                                     â”‚                                    â”‚
â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                            â”‚                 â”‚                          â”‚
â”‚                            â–¼                 â”‚                          â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚                          â”‚
â”‚                   â”‚ book_summaries  â”‚        â”‚                          â”‚
â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚        â”‚                          â”‚
â”‚                   â”‚ catalog_id (FK) â”‚        â”‚                          â”‚
â”‚                   â”‚ title           â”‚        â”‚                          â”‚
â”‚                   â”‚ is_published    â”‚        â”‚                          â”‚
â”‚                   â”‚ created_by      â”‚        â”‚                          â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚                          â”‚
â”‚                            â”‚                 â”‚                          â”‚
â”‚                            â–¼                 â”‚                          â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚                          â”‚
â”‚                   â”‚summary_chapters â”‚        â”‚                          â”‚
â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚        â”‚                          â”‚
â”‚                   â”‚ chapter_number  â”‚        â”‚                          â”‚
â”‚                   â”‚ title           â”‚        â”‚                          â”‚
â”‚                   â”‚ content (MD)    â”‚        â”‚                          â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚                          â”‚
â”‚                                              â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CAMADA PESSOAL (UsuÃ¡rio)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚                          â”‚
â”‚  â”‚  auth.users  â”‚                            â”‚                          â”‚
â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                            â”‚                          â”‚
â”‚  â”‚ id           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚                          â”‚
â”‚  â”‚ email        â”‚            â”‚               â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚               â”‚                          â”‚
â”‚         â”‚                    â”‚               â”‚                          â”‚
â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚         â”‚    â”‚               â”‚                                          â”‚
â”‚         â”‚    â–¼               â–¼                                          â”‚
â”‚         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚         â”‚ â”‚user_favoritesâ”‚ â”‚  user_notes  â”‚                              â”‚
â”‚         â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                              â”‚
â”‚         â”‚ â”‚ user_id     â”‚ â”‚ user_id      â”‚                              â”‚
â”‚         â”‚ â”‚ catalog_id  â”‚ â”‚ catalog_id   â”‚                              â”‚
â”‚         â”‚ â”‚ favorited_atâ”‚ â”‚ type         â”‚                              â”‚
â”‚         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ content      â”‚                              â”‚
â”‚         â”‚       â–²         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚         â”‚       â”‚                                                        â”‚
â”‚         â”‚       â”‚ "Meus Favoritos"                                      â”‚
â”‚         â”‚       â”‚                                                        â”‚
â”‚         â”‚                                                                â”‚
â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚         â”œâ”€â”€â”€â–ºâ”‚ reading_preferences â”‚    â”‚ summary_reading_progressâ”‚    â”‚
â”‚         â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚
â”‚         â”‚    â”‚ user_id             â”‚    â”‚ user_id                 â”‚    â”‚
â”‚         â”‚    â”‚ theme               â”‚    â”‚ summary_id              â”‚    â”‚
â”‚         â”‚    â”‚ font_size           â”‚    â”‚ current_chapter         â”‚    â”‚
â”‚         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ completed               â”‚    â”‚
â”‚         â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                                                                â”‚
â”‚         â””â”€â”€â”€â–ºâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚              â”‚    reading_goals    â”‚                                    â”‚
â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                    â”‚
â”‚              â”‚ user_id             â”‚                                    â”‚
â”‚              â”‚ year                â”‚                                    â”‚
â”‚              â”‚ target_books        â”‚                                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Abas da Interface

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BIBLIOTECA                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚   EXPLORAR   â”‚  â”‚  FAVORITOS   â”‚  â”‚   AUTORES    â”‚                   â”‚
â”‚  â”‚   (CatÃ¡logo) â”‚  â”‚ (Meus Livros)â”‚  â”‚              â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ EXPLORAR                                                        â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  Todos os livros do catÃ¡logo                                    â”‚   â”‚
â”‚  â”‚  Filtros: categoria, com resumo, busca                          â”‚   â”‚
â”‚  â”‚  Cada card tem botÃ£o â™¡ para favoritar                           â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ FAVORITOS                                                       â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  Livros que o usuÃ¡rio favoritou                                 â”‚   â”‚
â”‚  â”‚  Mostra progresso do resumo (se disponÃ­vel)                     â”‚   â”‚
â”‚  â”‚  Badge "Resumo disponÃ­vel" se tem resumo publicado              â”‚   â”‚
â”‚  â”‚  Acesso rÃ¡pido para ler resumo                                  â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Fluxos de Dados

### 1. Admin Adiciona Livro ao CatÃ¡logo

```
Admin â†’ Busca "Deep Work" â†’ Google Books API â†’ Seleciona resultado
                                                      â†“
                              INSERT book_catalog (se nÃ£o existe)
                                                      â†“
                                         Livro disponÃ­vel no catÃ¡logo
```

### 2. Admin Cria Resumo

```
Admin â†’ Seleciona livro do catÃ¡logo â†’ Cria book_summary
                                              â†“
                              Adiciona summary_chapters (1, 2, 3...)
                                              â†“
                              Publica (is_published = true)
                                              â†“
                              Resumo visÃ­vel para todos
```

### 3. UsuÃ¡rio Favorita Livro

```
UsuÃ¡rio â†’ Navega catÃ¡logo â†’ Clica â™¡ em "Deep Work"
                                      â†“
                    INSERT user_favorites (user_id, catalog_id)
                                      â†“
                    TRIGGER: book_catalog.favorites_count += 1
                                      â†“
                    Livro aparece em "Meus Favoritos"
```

### 4. UsuÃ¡rio LÃª Resumo

```
UsuÃ¡rio â†’ Abre livro favoritado â†’ Clica "Ler Resumo"
                                          â†“
                          Abre Modo Leitura (capÃ­tulo 1 ou Ãºltimo)
                                          â†“
                          Navega capÃ­tulos (â† â†’)
                                          â†“
                          UPSERT summary_reading_progress
                                          â†“
                          Ao terminar: completed = true
```

---

## PermissÃµes (RLS)

| Tabela | Leitura | Escrita |
|--------|---------|---------|
| `book_catalog` | âœ… Todos | âš ï¸ Admin |
| `book_summaries` | âœ… Se publicado | âš ï¸ Admin |
| `summary_chapters` | âœ… Se resumo publicado | âš ï¸ Admin |
| `user_favorites` | ğŸ”’ PrÃ³prio usuÃ¡rio | ğŸ”’ PrÃ³prio usuÃ¡rio |
| `user_notes` | ğŸ”’ PrÃ³prio usuÃ¡rio | ğŸ”’ PrÃ³prio usuÃ¡rio |
| `reading_preferences` | ğŸ”’ PrÃ³prio usuÃ¡rio | ğŸ”’ PrÃ³prio usuÃ¡rio |
| `summary_progress` | ğŸ”’ PrÃ³prio usuÃ¡rio | ğŸ”’ PrÃ³prio usuÃ¡rio |

---

## Server Actions

```
lib/actions/
â”œâ”€â”€ catalog/
â”‚   â”œâ”€â”€ search.ts           searchBooks(), searchByISBN()
â”‚   â”œâ”€â”€ get.ts              getCatalogBooks(), getCatalogBook()
â”‚   â””â”€â”€ add.ts              addBookToCatalog() [ADMIN]
â”‚
â”œâ”€â”€ favorites/
â”‚   â”œâ”€â”€ toggle.ts           toggleFavorite()
â”‚   â”œâ”€â”€ get.ts              getUserFavorites()
â”‚   â””â”€â”€ check.ts            isFavorite()
â”‚
â”œâ”€â”€ notes/
â”‚   â”œâ”€â”€ create.ts           createNote()
â”‚   â”œâ”€â”€ get.ts              getNotes()
â”‚   â”œâ”€â”€ update.ts           updateNote()
â”‚   â””â”€â”€ delete.ts           deleteNote()
â”‚
â”œâ”€â”€ summaries/
â”‚   â”œâ”€â”€ get.ts              getSummary(), getSummaryWithChapters()
â”‚   â””â”€â”€ progress.ts         saveProgress(), getProgress()
â”‚
â”œâ”€â”€ admin/
â”‚   â””â”€â”€ summaries/
â”‚       â”œâ”€â”€ create.ts       createSummary()
â”‚       â”œâ”€â”€ update.ts       updateSummary()
â”‚       â”œâ”€â”€ publish.ts      publishSummary()
â”‚       â””â”€â”€ chapters.ts     addChapter(), updateChapter(), reorderChapters()
â”‚
â””â”€â”€ preferences/
    â””â”€â”€ reading.ts          savePreferences(), getPreferences()
```

---

## Views SQL

### `catalog_view`
CatÃ¡logo com informaÃ§Ãµes de resumo:
- Todos os campos de `book_catalog`
- `summary_id`, `has_published_summary`, `chapter_count`
- Dados do autor (`author_bio`, `author_photo`)

### `user_favorites_view`
Favoritos do usuÃ¡rio com dados completos:
- `favorite_id`, `favorited_at`
- Todos os campos do livro
- `summary_id`, `has_published_summary`, `chapter_count`
- Progresso do resumo (`current_chapter`, `summary_completed`)

---

## Arquivos para Usar

| Arquivo | Usar |
|---------|------|
| `SQL/003-biblioteca-schema-v3.sql` | âœ… **ESTE** |
| `TYPES/biblioteca.types.v3.ts` | âœ… **ESTE** |
| `SQL/001-*.sql`, `SQL/002-*.sql` | âŒ Deprecated |
| `TYPES/*.v1.ts`, `TYPES/*.v2.ts` | âŒ Deprecated |

---

## ComparaÃ§Ã£o V2 â†’ V3

| Aspecto | V2 | V3 |
|---------|----|----|
| Biblioteca pessoal | `user_books` (status, progresso) | `user_favorites` (apenas favorito) |
| Tracking livro fÃ­sico | âœ… Sim | âŒ Removido |
| Tracking resumo | âœ… Sim | âœ… Sim |
| Complexidade | MÃ©dia | **Baixa** |
| Tabelas | 10 | **9** |

---

*â€” Aria, arquitetando o futuro ğŸ—ï¸*
