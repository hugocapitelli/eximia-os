{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "Maestro Routing Schema",
    "description": "Schema for agent routing and tool calling decisions",
    "type": "object",
    "definitions": {
        "agent_invocation": {
            "type": "object",
            "properties": {
                "agent": {
                    "type": "string",
                    "enum": [
                        "The_Veritas",
                        "The_CLO",
                        "The_CFO",
                        "The_CTO",
                        "The_CMO"
                    ],
                    "description": "Target agent codename"
                },
                "alias": {
                    "type": "string",
                    "enum": [
                        "Justitia",
                        "Fiscus",
                        "Technicus",
                        "Mercator"
                    ],
                    "description": "Optional human-readable alias"
                },
                "priority": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 5,
                    "description": "Routing priority (1=highest)"
                },
                "request_type": {
                    "type": "string",
                    "enum": [
                        "research",
                        "analysis",
                        "synthesis",
                        "review",
                        "creation"
                    ],
                    "description": "Type of request"
                },
                "context": {
                    "type": "object",
                    "properties": {
                        "user_query": {
                            "type": "string"
                        },
                        "veritas_data": {
                            "type": "object"
                        },
                        "previous_outputs": {
                            "type": "array"
                        }
                    }
                },
                "instructions": {
                    "type": "string",
                    "description": "Specific instructions for the agent"
                },
                "expected_output": {
                    "type": "string",
                    "description": "Expected output format"
                }
            },
            "required": [
                "agent",
                "request_type"
            ]
        }
    },
    "properties": {
        "routing_decision": {
            "type": "object",
            "properties": {
                "decision_id": {
                    "type": "string"
                },
                "timestamp": {
                    "type": "string",
                    "format": "date-time"
                },
                "intent_classification": {
                    "type": "object",
                    "properties": {
                        "primary_intent": {
                            "type": "string",
                            "enum": [
                                "information_seeking",
                                "decision_support",
                                "task_execution",
                                "analysis",
                                "strategic_planning"
                            ]
                        },
                        "confidence": {
                            "type": "number",
                            "minimum": 0,
                            "maximum": 1
                        },
                        "domains_detected": {
                            "type": "array",
                            "items": {
                                "type": "string",
                                "enum": [
                                    "legal",
                                    "finance",
                                    "technology",
                                    "marketing",
                                    "general"
                                ]
                            }
                        }
                    }
                },
                "veritas_required": {
                    "type": "boolean",
                    "description": "Whether Veritas invocation is mandatory"
                },
                "agents_to_invoke": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/agent_invocation"
                    }
                },
                "execution_mode": {
                    "type": "string",
                    "enum": [
                        "sequential",
                        "parallel",
                        "conditional"
                    ],
                    "description": "How to execute agent calls"
                },
                "dependencies": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "agent": {
                                "type": "string"
                            },
                            "depends_on": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "tools": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "enum": [
                            "veritas_search",
                            "agent_invoke",
                            "memory_recall",
                            "context_summarize"
                        ]
                    },
                    "description": {
                        "type": "string"
                    },
                    "parameters": {
                        "type": "object"
                    }
                }
            },
            "description": "Available tools for orchestration"
        }
    },
    "tools_catalog": [
        {
            "name": "veritas_search",
            "description": "Invoke The_Veritas for research and fact verification",
            "parameters": {
                "query": {
                    "type": "string",
                    "required": true
                },
                "max_results": {
                    "type": "integer",
                    "default": 5
                },
                "freshness": {
                    "type": "string",
                    "enum": [
                        "current",
                        "recent",
                        "any"
                    ],
                    "default": "current"
                },
                "language": {
                    "type": "string",
                    "default": "pt-BR"
                }
            }
        },
        {
            "name": "agent_invoke",
            "description": "Route request to specialist agent",
            "parameters": {
                "agent": {
                    "type": "string",
                    "required": true
                },
                "request_type": {
                    "type": "string",
                    "required": true
                },
                "context": {
                    "type": "object"
                },
                "instructions": {
                    "type": "string"
                },
                "expected_output": {
                    "type": "string"
                }
            }
        },
        {
            "name": "memory_recall",
            "description": "Retrieve previous conversation context",
            "parameters": {
                "scope": {
                    "type": "string",
                    "enum": [
                        "session",
                        "project",
                        "user"
                    ]
                },
                "keywords": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "limit": {
                    "type": "integer",
                    "default": 5
                }
            }
        },
        {
            "name": "context_summarize",
            "description": "Summarize and prune context when approaching token limits",
            "parameters": {
                "preserve_recent": {
                    "type": "integer",
                    "description": "Number of recent turns to preserve"
                },
                "preserve_keywords": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        }
    ]
}